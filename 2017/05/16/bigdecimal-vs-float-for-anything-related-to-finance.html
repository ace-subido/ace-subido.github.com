<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>BigDecimal vs. Float for anything related to finance</title>
  <meta name="description" content="There are countless blog posts and stack overflow explanations about this, figured I need to write this little note for myself. To start things off, check th...">

  <meta name="twitter:card" content="summary_large_image">
  <meta content="acesubido" property="og:site_name">

  
    <meta content="BigDecimal vs. Float for anything related to finance" property="og:title">
    <meta content="BigDecimal vs. Float for anything related to finance" property="twitter:title">
  

  
    <meta content="article" property="og:type">
  

  
    <meta content="There are countless blog posts and stack overflow explanations about this, figured I need to write this little note for myself. To start things off, check th..." property="og:description">
    <meta content="There are countless blog posts and stack overflow explanations about this, figured I need to write this little note for myself. To start things off, check th..." property="twitter:description">
  

  
    <meta content="https://acesubido.net/2017/05/16/bigdecimal-vs-float-for-anything-related-to-finance.html" property="og:url">
  

  
    <meta content="2017-05-16T00:00:00+08:00" property="article:published_time">
    <meta content="https://acesubido.net/about/" property="article:author">
  

  
    <meta content="https://acesubido.net/img/logo-hires.png" property="og:image">
    <meta content="https://acesubido.net/img/logo-hires.png" property="twitter:image">
  

  <link rel="stylesheet" href="https://acesubido.net/css/main.css">
  <link rel="canonical" href="https://acesubido.net/2017/05/16/bigdecimal-vs-float-for-anything-related-to-finance.html">
  <link rel="alternate" type="application/rss+xml" title="acesubido" href="/feed.xml" />
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
</head>

  <body>
    <header class="site-header">
  <div class="site-title">
    <ul class="navigation-links-list">
      <li>
        acesubido
        &mdash;
      </li>
      <li>
        <a href="/">home</a>
      </li>
      <li>
        <a href="/posts">posts</a>
      </li>
      <li>
        <a href="/feed.xml">rss feed (archived)</a>
      </li>
    </ul>
  </div>
</header>

    <div class="container">
      <section class="post-full">
  <header>
    <span class="post-date">
      May 16, 2017
      
      
    </span>
    <h1 class="post-full-title">BigDecimal vs. Float for anything related to finance</h1>
  </header>
  <hr class="post-divider"/>
  <article>
    <p>There are countless blog posts and stack overflow explanations about this, figured I need to write this little note for myself. To start things off, check this example of computing PHPKRW using hypothetical gold as a go-between:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>require "bigdecimal"

# Float
php_gold_float = 0.00001144792038
gold_krw_float = 1962165.41

php_krw_float = php_gold_float * gold_krw_float

puts "#{php_krw_float.class} #{php_krw_float}"

# Big Decimal
php_gold_bd = BigDecimal.new("0.00001144792038")
gold_krw_bd = BigDecimal.new("1962165.41")

php_krw_bd = php_gold_bd * gold_krw_bd

puts "#{php_krw_bd.class} #{php_krw_bd.to_s('F')}"

# Output
Float 22.462713386070057
BigDecimal 22.4627133860700558
</code></pre></div></div>

<h4 id="thats-odd-its-rounded-up-or-something-why-does-this-happen">That’s odd, it’s rounded up? Or something? Why does this happen?</h4>

<p>Long version, read up on <a href="https://en.wikipedia.org/wiki/IEEE_floating_point#IEEE_754-2008">IEEE specification to define floats</a>. Short version: it stores a sign, a fraction and an exponent to represent a Float. It’s a scientific notation for binary, because of that it’s impossible to store exact numbers and decimal in Float.</p>

<hr />

<p>If you’re a bank, or if you’re supporting accounting software, or just computing compounding interests, you could potentially miscalculate thousands down the line when using Float for computing. So, make sure to use BigDecimal when you’re dealing with anything that requires a high-degree of “sureness”. With Ruby/Rails, you can use <code class="highlighter-rouge">:decimal</code> for columns containing this type of information.</p>

<p>Money, accounting, computing compounding interests = needs high precision, then use BigDecimal. Other than that, just use float.</p>

<p>Some gotcha’s: With Ruby/Rails, when rendering an object with BigDecimal attributes as JSON, it will render the numbers as a String, instead of a Float. Part of the reasoning behind this change could be found in this <a href="https://github.com/rails/rails/issues/25017">discussion</a></p>


  </article>
</section>

    </div>
    <footer class="site-footer">
  <nav class="footer-links">
    <ul class="navigation-links-list">
      <li>
        acesubido
        &mdash;
      </li>
      <li>
        <a href="/">home</a>
      </li>
      <li>
        <a href="/archived_posts">posts (archived)</a>
      </li>
      <li>
        <a href="/feed.xml">rss feed (archived)</a>
      </li>
    </ul>
  </nav>
</footer>

<script type="text/javascript" src="/javascript/google-analytics.js"></script>

  </body>

</html>
